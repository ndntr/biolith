<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile Layout Fix Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #e7e6e0;
            font-family: sans-serif;
        }
        
        .test-container {
            position: fixed;
            top: 10px;
            right: 10px;
            background: white;
            padding: 15px;
            border: 2px solid #333;
            border-radius: 5px;
            z-index: 10000;
            font-size: 12px;
            max-width: 200px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .test-container h3 {
            margin-bottom: 10px;
            font-size: 14px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        
        .test-info {
            margin: 5px 0;
        }
        
        .status-good {
            color: green;
            font-weight: bold;
        }
        
        .status-bad {
            color: red;
            font-weight: bold;
        }
        
        .viewport-simulator {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: white;
            padding: 10px;
            border: 2px solid #333;
            border-radius: 5px;
            z-index: 10000;
        }
        
        .viewport-btn {
            margin: 2px;
            padding: 5px 10px;
            cursor: pointer;
            background: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 3px;
        }
        
        .viewport-btn:hover {
            background: #e0e0e0;
        }
        
        .viewport-btn.active {
            background: #333;
            color: white;
        }
        
        iframe {
            border: 1px solid #333;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h3>Layout Test Status</h3>
        <div class="test-info">
            Width: <span id="width">-</span>px
        </div>
        <div class="test-info">
            H-Scroll: <span id="hscroll">-</span>
        </div>
        <div class="test-info">
            Body Width: <span id="bodyWidth">-</span>px
        </div>
        <div class="test-info">
            Overflow: <span id="overflow">-</span>
        </div>
        <hr style="margin: 10px 0;">
        <div class="test-info">
            <strong>Tab Visibility:</strong>
        </div>
        <div id="tabStatus" style="font-size: 11px; margin-top: 5px;">
            Checking...
        </div>
    </div>
    
    <div class="viewport-simulator">
        <h4>Test Viewports:</h4>
        <button class="viewport-btn" onclick="setViewport(320)">iPhone SE (320px)</button>
        <button class="viewport-btn" onclick="setViewport(375)">iPhone 12 (375px)</button>
        <button class="viewport-btn" onclick="setViewport(414)">iPhone Plus (414px)</button>
        <button class="viewport-btn" onclick="setViewport(550)">Max Mobile (550px)</button>
        <button class="viewport-btn" onclick="setViewport(768)">iPad (768px)</button>
        <button class="viewport-btn" onclick="resetViewport()">Reset</button>
    </div>
    
    <iframe id="testFrame" src="/" style="width: 100%; height: calc(100vh - 150px); border: none;"></iframe>
    
    <script>
        let originalWidth = window.innerWidth;
        
        function checkLayout() {
            const frame = document.getElementById('testFrame');
            const frameDoc = frame.contentDocument || frame.contentWindow.document;
            
            // Check viewport width
            const width = frame.offsetWidth;
            document.getElementById('width').textContent = width;
            
            // Check for horizontal scroll
            const hasHScroll = frameDoc.body.scrollWidth > width;
            const hscrollEl = document.getElementById('hscroll');
            hscrollEl.textContent = hasHScroll ? 'YES' : 'NO';
            hscrollEl.className = hasHScroll ? 'status-bad' : 'status-good';
            
            // Check body width
            const bodyWidth = frameDoc.body.scrollWidth;
            document.getElementById('bodyWidth').textContent = bodyWidth;
            
            // Check for overflow
            const hasOverflow = bodyWidth > width;
            const overflowEl = document.getElementById('overflow');
            overflowEl.textContent = hasOverflow ? 'Content Overflow!' : 'None';
            overflowEl.className = hasOverflow ? 'status-bad' : 'status-good';
            
            // Check tab visibility
            checkTabs(frameDoc);
        }
        
        function checkTabs(doc) {
            const tabs = doc.querySelectorAll('.news-tab');
            const tabContainer = doc.querySelector('.news-tabs');
            const statusEl = document.getElementById('tabStatus');
            
            if (tabs.length === 0 || !tabContainer) {
                statusEl.innerHTML = 'Tabs not found';
                return;
            }
            
            let statusHTML = '';
            const containerRect = tabContainer.getBoundingClientRect();
            
            tabs.forEach(tab => {
                const rect = tab.getBoundingClientRect();
                const isVisible = rect.right <= containerRect.right && rect.left >= containerRect.left;
                const color = isVisible ? 'green' : 'red';
                statusHTML += `<div style="color: ${color}">${tab.textContent.trim()}: ${isVisible ? '✓' : '✗ Cut off'}</div>`;
            });
            
            statusEl.innerHTML = statusHTML;
        }
        
        function setViewport(width) {
            const frame = document.getElementById('testFrame');
            frame.style.width = width + 'px';
            
            // Mark active button
            document.querySelectorAll('.viewport-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(width + 'px')) {
                    btn.classList.add('active');
                }
            });
            
            setTimeout(checkLayout, 500);
        }
        
        function resetViewport() {
            const frame = document.getElementById('testFrame');
            frame.style.width = '100%';
            document.querySelectorAll('.viewport-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            setTimeout(checkLayout, 500);
        }
        
        // Check layout when frame loads
        document.getElementById('testFrame').onload = function() {
            setTimeout(checkLayout, 1000);
        };
        
        // Check on resize
        window.addEventListener('resize', () => {
            setTimeout(checkLayout, 100);
        });
    </script>
</body>
</html>